# 软件集体开发契约

------
- 作者: Pieter Hintjens <ph@imatix.com>
- 译者: 谢宇恒 / Xie Yuheng <xyheme@gmail.com>
------

软件集体开发契约 (Collective Code Construction Contract (C4)) <br>
衍生于 github.com [分叉 + 拉回 模型](https://help.github.com/articles/about-pull-requests/), <br>
旨在为自由软件项目提供最优的合作模型. <br>
这是 C4 的第二次修订版 以取代 RFC 22.

- **[注]** 这里所说的 RFC 是 ZeroMQ 社区内部的 RFC, 这个文档是 RFC 42.

## 摘要

C4 为贡献与评估软件项目的改进提供了一个标准流程. <br>
它定义了软件项目的特殊技术需求 例如 风格指导 (style guide), 单元测试 (unit tests), `git` 以及类似平台. <br>
它同时也描绘了项目中的不同角色, 各个角色使命分明各司其职. <br>
C4 明确了一个记录与讨论问题 (issues) 的流程, 包括:
- 清晰记述.
- 寻求共识.
- 使用 "pull requests" 与 系统的代码审查.

## 用语

本文档中如下用语的解释请参考 [RFC 2119](http://tools.ietf.org/html/rfc2119).
- "必须" -- "MUST".
- "应该" -- "SHALL", "SHOULD".
- "无妨" -- "MAY".

## 1. 目标

C4 旨在为开源软件项目提供可复用的最优合作模型. 其目标如下:

1. 减少新贡献者所遇到的阻力, 造一个有强有力的正反馈的可规模化的参与模型, <br>
   以使得围绕项目所形成社区的规模和多样性达到最大.
1. 分离不同的技能集, 使得在每个所需要的领域都有足够的人能胜任, <br>
   以缓解对关键个体的依赖.
1. 加强决策过程中的多元性, <br>
   以使项目的发展更快速并且正确.
1. 允许安全的实验与敏捷的失败, 分离稳定的代码,
   来支持项目从实验到稳定的自然生命周期. <br>
1. 减少项目代码库的内部复杂度, <br>
   从而使贡献者更容易参与, 并且减少出错的范围.
1. 加强对项目的集体所有权, <br>
   以增加对贡献者的经济鼓励, 并且降低项目被居心叵测者所劫持的风险.

## 2. 设计

### 2.1. 准备

1. The project SHALL use the git distributed revision control system.
1. The project SHALL be hosted on github.com or equivalent, herein called the "Platform".
1. The project SHALL use the Platform issue tracker.
1. The project SHOULD have clearly documented guidelines for code style.
1. A "Contributor" is a person who wishes to provide a patch, being a set of commits that solve some clearly identified problem.
1. A "Maintainer" is a person who merges patches to the project. Maintainers are not developers; their job is to enforce process.
1. Contributors SHALL NOT have commit access to the repository unless they are also Maintainers.
1. Maintainers SHALL have commit access to the repository.
1. Everyone, without distinction or discrimination, SHALL have an equal right to become a Contributor under the terms of this contract.

### 2.2. 协议与所有权

1. The project SHALL use a share-alike license such as the MPLv2, or a GPLv3 variant thereof (GPL, LGPL, AGPL).
1. All contributions to the project source code ("patches") SHALL use the same license as the project.
1. All patches are owned by their authors. There SHALL NOT be any copyright assignment process.
1. Each Contributor SHALL be responsible for identifying themselves in the project Contributor list.

### 2.3. 补丁要务

1. 维护者和贡献者必须有平台账户并且应该使用真实姓名或者众所周知的化名.
1. 一个补丁应该是对一个公认问题的回答, 这个回答应该最简而且精确.
1. 补丁必须遵从项目的代码风格.
1. 补丁必须遵从下面的 "公共契约之演化".
1. 补丁不应该带有从其他项目抄来的非平凡的代码, 贡献者是这份代码的原作者的情况除外.
1. 补丁必须能干净利落通过编译, 并且通过项目的所有自我测试 (至少在主要目标平台上要通过相关测试).
1. 补丁的提交信息必须由一行对问题的描述构成 (必须少于 50 字) (模板为 "Problem: ..."), 空一行, <br>
   接着描述所提出的解法 (模板为 "Solution: ...").
1. "正确的补丁" 定义为满足上述条件的补丁.

### 2.4. 开发流程

1. Change on the project SHALL be governed by the pattern of accurately identifying problems and applying minimal, accurate solutions to these problems.
1. To request changes, a user SHOULD log an issue on the project Platform issue tracker.
1. The user or Contributor SHOULD write the issue by describing the problem they face or observe.
1. The user or Contributor SHOULD seek consensus on the accuracy of their observation, and the value of solving the problem.
1. Users SHALL NOT log feature requests, ideas, suggestions, or any solutions to problems that are not explicitly documented and provable.
1. Thus, the release history of the project SHALL be a list of meaningful issues logged and solved.
1. To work on an issue, a Contributor SHALL fork the project repository and then work on their forked repository.
1. To submit a patch, a Contributor SHALL create a Platform pull request back to the project.
1. A Contributor SHALL NOT commit changes directly to the project.
1. If the Platform implements pull requests as issues, a Contributor MAY directly send a pull request without logging a separate issue.
1. To discuss a patch, people MAY comment on the Platform pull request, on the commit, or elsewhere.
1. To accept or reject a patch, a Maintainer SHALL use the Platform interface.
1. Maintainers SHOULD NOT merge their own patches except in exceptional cases, such as non-responsiveness from other Maintainers for an extended period (more than 1-2 days).
1. Maintainers SHALL NOT make value judgments on correct patches.
1. Maintainers SHALL merge correct patches from other Contributors rapidly.
1. Maintainers MAY merge incorrect patches from other Contributors with the goals of (a) ending fruitless discussions, (b) capturing toxic patches in the historical record, (c) engaging with the Contributor on improving their patch quality.
1. The user who created an issue SHOULD close the issue after checking the patch is successful.
1. Any Contributor who has value judgments on a patch SHOULD express these via their own patches.
1. Maintainers SHOULD close user issues that are left open without action for an uncomfortable period of time.

### 2.5. 分支与发布

1. 项目应该只有一个分支 ("master"), 它总是包含最新的发展中的版本, 并且应该随时能构建起来.
1. 项目不应以任何理由使用主题分支. 个人的分叉无妨使用主题分支.
1. 维护者应该通过给代码库加标签来形成一个稳定发布. 稳定发布应该总是从主代码库的 master 分支发出.

### 2.6. 公共契约之演化

1. All Public Contracts (APIs or protocols) SHALL be documented.
1. All Public Contracts SHOULD have space for extensibility and experimentation.
1. A patch that modifies a stable Public Contract SHOULD not break existing applications unless there is overriding consensus on the value of doing this.
1. A patch that introduces new features SHOULD do so using new names (a new contract).
1. New contracts SHOULD be marked as "draft" until they are stable and used by real users.
1. Old contracts SHOULD be deprecated in a systematic fashion by marking them as "deprecated" and replacing them with new contracts as needed.
1. When sufficient time has passed, old deprecated contracts SHOULD be removed.
1. Old names SHALL NOT be reused by new contracts.

### 2.7. 项目管理

1. The project founders SHALL act as Administrators to manage the set of project Maintainers.
1. The Administrators SHALL ensure their own succession over time by promoting the most effective Maintainers.
1. A new Contributor who makes correct patches, who clearly understands the project goals, and the process SHOULD be invited to become a Maintainer.
1. Administrators SHOULD remove Maintainers who are inactive for an extended period of time, or who repeatedly fail to apply this process accurately.
1. Administrators SHOULD block or ban "bad actors" who cause stress and pain to others in the project. This should be done after public discussion, with a chance for all parties to speak. A bad actor is someone who repeatedly ignores the rules and culture of the project, who is needlessly argumentative or hostile, or who is offensive, and who is unable to self-correct their behavior when asked to do so by others.

## 延伸读物

* [Argyris 模型 1 与 2](http://en.wikipedia.org/wiki/Chris_Argyris) - C4 的目标与 Argyris 模型 2 一致.
* [Toyota Kata](http://en.wikipedia.org/wiki/Toyota_Kata) - 包含了 改进 Kata (一次一个处理问题) 与 指导 Kata (帮助他人学习 改进 Kata).

## 实现者

* [ZeroMQ 社区](http://zeromq.org) 在很多项目中使用了 C4 流程.
* [OSSEC](http://www.ossec.net/) [使用 C4 流程](https://ossec-docs.readthedocs.org/en/latest/development/oRFC/orfc-1.html).
* [Machinekit](http://www.machinekit.io/) 社区 [使用 C4 流程](http://www.machinekit.io/about/).
